window.init=async()=>{const t=(t,e)=>{let n=Element('div','tab').txt(e),a=Element('div','con');return n.onclick=()=>{[...t.children].forEach(t=>{'tab'===t.className?css(t,t===n?{color:'#18f',background:'#def'}:{color:'',background:''}):'con'===t.className&&(t.style.display=t===a?'block':'')})},t.ap(n,a),a};(await new AV.Query('Data').ascending('yaer').find({useMasterKey:!0})).forEach(async e=>{let n=t(document.body,'FASF'+e.get('year')),a=t(n,'介绍(中文)'),l=bind(Element('textarea'),e,'intro',t=>t,'',t=>t||''),r=t(n,'介绍(英文)'),i=bind(Element('textarea'),e,'introE',t=>t,'',t=>t||''),m=t(n,'作品'),o=bind(Element('textarea'),e,'game',t=>{try{return JSON.parse(t)}catch{return null}},[],t=>JSON.stringify(t,null,2));a.ap(codeBox(l,HTMLParser,1)),l.oninput(),r.ap(codeBox(i,HTMLParser,1)),i.oninput(),m.ap(codeBox(o,JSONParser,1)),o.oninput();let d=t(n,'时间表'),s=Element('tbody');d.ap(Element('table').ap(Element('thead').ap(Element('tr').ap(Element('th').txt('#'),Element('th').txt('日期'),Element('th').txt('项目'),Element('th').txt('时间'),Element('th').txt('流程'),Element('th').txt('分类'),Element('th').txt('选手'),Element('th').txt('回放'))),s));(await new AV.Query('Schedule').equalTo('y',e.get('year')).ascending('s').find({useMasterKey:!0})).forEach(t=>{s.ap(Element('tr').ap(Element('td'),Element('td').txt(Time.toDate(t.get('s'))),css(Element('td'),{width:'20%'}).txt(t.get('g').map(t=>t.split('=')[0]).join(', ')),Element('td').txt(Time.formatMin(t.get('e'))),css(Element('td'),{width:'10%'}).txt(t.get('c')||'Any%'),Element('td').txt(t.get('t')||'Solo Run'),css(Element('td'),{width:'20%'}).txt(t.get('r').map(t=>t.split('/')[0].split(':')[0].split('>')[0]).join(', ')),Element('td').ap(bind(Element('input'),t,'v',''))))})})};